<!DOCTYPE html>
<html>
<head>
    <title>Music Player</title>
    <link rel="stylesheet" href="/static/Styles/style.css">
</head>
<body>
<div class="gridcontainer">
        <div class="grid">
            <div class="headingdiv">
                <p class="heading">Music Player</p>
        </div>
        <div class="song-list-container">
              <h2>Songs</h2>
              <ul id="song-list">
              </ul>
        </div>

    
    <div class="name">
            <p id="songName"></p>
    </div>
    <div class="player">
        <audio controls autoplay="true" id="audioPlayer" class="playeraudio1">
            <source src="/static/audio/song1.mp3" type="audio/mpeg">
        </audio>
    </div>
    <!-- HTML -->
<input type="range" id="seekBar" value="0" max="100">

    <div class="buttons">
        <div class="butdiv">
            <button id="prev">
            <button type="button" onclick="previous()">Previous</button>
        </button>
        </div>
        <div class="butdiv">
            <button id="next">
                <button type="button" onclick="next()">Next</button>
            </button>
        </div>
        <div class="butdiv">
            <button type="button" onclick="togglePlayPause()">Play/Pause</button>
        </div>
        <div class="butdiv">
            <button type="button" id="shuffleButton" onclick="toggleShuffle()">Shuffle</button>
        </div>
        
    </div>
    
    </div>
    </div>


<script>
// const songElement = document.getElementById('songName');
const songListElement = document.getElementById("song-list");
var songs = ["/static/audio/song1.mp3", "/static/audio/song2.mp3", "/static/audio/song3.mp3"];
var currentSongIndex = 0;
var shuffle=false; 
const audioPlayer = document.getElementById("audioPlayer");

// songElement.innerText = `song${currentSongIndex}`
function togglePlayPause() {
  // var audioPlayer = document.getElementById("audioPlayer");

  if (audioPlayer.paused) {
    audioPlayer.play();
  } else {
    audioPlayer.pause();
  }
}

function next() {
  const nextSongIndex = getNextSongIndex();
  currentSongIndex = nextSongIndex;
  audioPlayer.src = songs[nextSongIndex];
  audioPlayer.play();
}

function previous() {
  const prevSongIndex = getPrevSongIndex();
  currentSongIndex = prevSongIndex;
  audioPlayer.src = songs[prevSongIndex];
  audioPlayer.play();
}
function getNextSongIndex() {
  if (shuffle) {
    return getRandomSongIndex();
  }
  return (currentSongIndex + 1) % songs.length;
}

function getPrevSongIndex() {
  if (shuffle) {
    return getRandomSongIndex();
  }
  return (currentSongIndex - 1 + songs.length) % songs.length;
}

function getRandomSongIndex() {
  const currentIndex = currentSongIndex;
  let randomIndex = currentIndex;
  while (randomIndex === currentIndex) {
    randomIndex = Math.floor(Math.random() * songs.length);
  }
  return randomIndex;
}
function toggleShuffle() {
  if (shuffle===true){
    shuffle=false;
  } else{
    shuffle=true;
  }
}
// const audioPlayer = document.getElementById("audioPlayer");
const songNameElement = document.getElementById("songName");

// Update the song name element when the audio player starts playing a new song.
audioPlayer.addEventListener("play", () => {
  const songName = audioPlayer.currentSrc.split("/").pop();
  songNameElement.textContent = songName;
});


// const songListElement = document.getElementById("song-list");

songs.forEach((song) => {
  const songListItemElement = document.createElement("li");
  // Get the name of the song from the URL.
  const songName = song.split("/").pop();
  songListItemElement.textContent = songName;
  songListElement.appendChild(songListItemElement);
});
songListElement.addEventListener("click", (event) => {
  // Get the song URL from the clicked song list item element.
  var songUrl = event.target.textContent;
  songUrl='/static/audio/'+songUrl;
  // Set the audio player source to the song URL.
  console.log(songUrl);
  audioPlayer.src = songUrl;
  // Play the song.
  audioPlayer.play();
});
// JavaScript
var seekBar = document.getElementById("seekBar");

seekBar.addEventListener("change", function () {
    var time = audioPlayer.duration * (seekBar.value / 100);
    audioPlayer.currentTime = time;
});

audioPlayer.addEventListener("timeupdate", function () {
    var value = (audioPlayer.currentTime / audioPlayer.duration) * 100;
    seekBar.value = value;
});

//   if (isShuffled) {
//     shuffleButton.classList.remove("active");
//     isShuffled = false;
//     audioPlayer.src = songs[currentSongIndex];
//   } else {
//     shuffleButton.classList.add("active");
//     isShuffled = true;
//     shuffleSongs();
//     currentSongIndex = 0;
//     audioPlayer.src = songs[currentSongIndex];
//   }
// }

// function shuffleSongs() {
//   songs.sort(() => Math.random() - 0.5);
// }
</script>
</body>
</html>
